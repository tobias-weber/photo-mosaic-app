<div class="card p-4">
    <h3>Register</h3>
    <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="mb-3">
            <label class="form-label">Username</label>
            <input type="text" class="form-control" formControlName="username" autocomplete="username"
                   [class.is-invalid]="name && name.invalid && (name.dirty || name.touched)"/>
            @if (name && name.invalid && (name.dirty || name.touched)) {
                <div class="invalid-feedback">
                    @if (name.hasError('required')) {
                        Name is required.
                    } @else if (name.hasError('maxlength')) {
                        Name must be at most {{ maxNameLength }} characters long.
                    } @else if (name.hasError('pattern')) {
                        Name must only contain letters and digits.
                    }
                </div>
            }
        </div>
        <div class="mb-3">
            <label class="form-label">Password</label>
            <input type="password" class="form-control" formControlName="password" autocomplete="new-password"
                   [class.is-invalid]="pw && pw.invalid && (pw.dirty || pw.touched)"/>
            @if (pw && pw.invalid && (pw.dirty || pw.touched)) {
                <div class="invalid-feedback">
                    @if (pw.hasError('required')) {
                        Password is required.
                    } @else if (pw.hasError('minlength')) {
                        Password must be at least {{ minPwLength }} characters long.
                    } @else if (pw.hasError('maxlength')) {
                        Password must be at most {{ maxPwLength }} characters long.
                    }
                </div>
            }
        </div>
        <div class="mb-3">
            <label class="form-label">Confirm Password</label>
            <input type="password" class="form-control" formControlName="confirmPassword" autocomplete="new-password"
                   [class.is-invalid]="confirmPw && (confirmPw.invalid || form.hasError('passwordMismatch')) && (confirmPw.dirty || confirmPw.touched)"/>
            @if (confirmPw && (confirmPw.invalid || form.hasError('passwordMismatch')) && (confirmPw.dirty || confirmPw.touched)) {
                <div class="invalid-feedback">
                    @if (confirmPw.hasError('required')) {
                        Please confirm the password.
                    } @else if (form.hasError('passwordMismatch')) {
                        Passwords do not match.
                    }
                </div>
            }
        </div>

        @if (error()) {
            <div class="alert alert-danger mb-3">{{ error() }}</div>
        }

        <button type="submit" class="btn btn-success w-100" [disabled]="form.invalid">
            Register
        </button>
    </form>
</div>
