<div class="mt-3">
    <h2>Your Projects</h2>

    @if (projects().length === 0) {
        <p>No projects found.</p>
    } @else {
        <div class="list-group mt-3">
            @for (project of projects(); track project.projectId) {
                <button
                    class="list-group-item list-group-item-action d-flex justify-content-between align-items-center project-item"
                    [routerLink]="[project.projectId]">
                    <span class="project-title">{{ project.title }}</span>
                    <div>
                        <small class="text-muted">{{ project.createdAt | date:'short' }}</small>
                        <button class="ms-3 btn btn-outline-danger"
                                (click)="$event.stopPropagation(); deleteProject(project)">Delete
                        </button>
                    </div>
                </button>
            }
        </div>
    }

    <div class="row mt-3">
        <div class="col-12 col-lg-6 ms-auto">
            <form [formGroup]="newProjectForm" (ngSubmit)="createProject()">
                <div class="input-group has-validation">
                    <input type="text" class="form-control"
                           placeholder="Project Title"
                           formControlName="title"
                           [class.is-invalid]="projectTitle && projectTitle.invalid && (projectTitle.dirty || projectTitle.touched)">
                    <button class="btn btn-outline-secondary" type="submit" [disabled]="newProjectForm.invalid">
                        New Project
                    </button>
                    <div class="invalid-feedback">
                        @if (projectTitle && projectTitle.invalid && (projectTitle.dirty || projectTitle.touched)) {
                            @if (projectTitle.hasError('required')) {
                                Title is required.
                            } @else if (projectTitle.hasError('maxlength')) {
                                Title cannot exceed {{ maxTitleLength }} characters.
                            } @else if (projectTitle.hasError('pattern')) {
                                Name must only contain letters, digits, -, _ or spaces.
                            }
                        }
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
